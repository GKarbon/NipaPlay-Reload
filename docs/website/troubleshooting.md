# 故障排查

## 常见症状与处理

- 启动崩溃/无法启动：删除配置（备份后）、重装、查看日志。
- 无法播放：尝试更换播放器内核、检查解码与硬件加速。
- 无法扫描媒体：检查目录权限（桌面系统）、存储权限（Android）。
- 界面卡顿：关闭高占用程序，检查 GPU 驱动与系统更新。

## 应用启动问题

### 意外断电后无法启动 NipaPlay（Windows）

**症状**：电脑在运行中意外死机、断电或蓝屏重启后，NipaPlay 无法正常启动

**具体表现**：

- 启动 NipaPlay 后有进程在运行（可在任务管理器中看到）
- 但是不会显示用户界面（UI 界面不出现）
- 卸载重装应用也无法解决问题

**原因**：意外断电导致配置文件 `shared_preferences.json` 损坏

**解决方案**：

1. **完全关闭 NipaPlay**：
   - 在任务管理器中结束所有 NipaPlay 相关进程

2. **找到配置文件**：
   - 按 `Win + R` 打开运行对话框
   - 输入 `%APPDATA%` 并回车，或者直接输入：

     ```text
     %APPDATA%\Roaming\com.aimessoft\nipaplay
     ```

   - 找到 `shared_preferences.json` 文件

3. **删除损坏的配置文件**：
   - 删除 `shared_preferences.json` 文件
   - （可选）备份该文件以便后续分析问题

4. **重新启动应用**：
   - 启动 NipaPlay，应用将自动创建新的配置文件
   - 应用会以默认设置启动


## Windows 特定问题

### 播放 3 秒后崩溃/黑屏

**症状**：视频播放几秒钟后程序崩溃或显示黑屏

**可能原因**：

- libmpv 解码器不完整，无法处理特定视频格式
- CPU 指令集不支持当前使用的 libmpv 版本

**解决方案**：

1. 切换到其他播放器内核（MDK 或 Video Player）
2. 如使用 Libmpv 内核，参考 [高级设置 - Windows 平台解码器优化](settings.md#windows-平台解码器优化) 替换完整版 libmpv
3. 确认 CPU 支持相应指令集（AVX/AVX2）

### 高清/HDR 视频无法播放

**症状**：H.265、10bit、HDR、杜比视界以及PGS字幕等无法播放

**解决方案**：

1. 参考 [高级设置](settings.md) 中的 Windows 解码器优化方案
2. 确保显卡驱动为最新版本
3. 尝试启用硬件解码（如支持）

### 替换 libmpv 后程序无法启动

**症状**：替换 libmpv-2.dll 后程序直接报错或崩溃

**可能原因**：

- CPU 不支持所选 libmpv 版本的指令集要求
- 下载的库文件损坏或版本不匹配

**解决方案**：

1. 恢复备份的原始 libmpv-2.dll 文件
2. 检查 CPU 指令集支持：
   - Intel 4代及以上：可使用 V3 版本
   - Intel 2-3代：仅可使用普通版本
   - 更老的 CPU：无法使用此优化方案
3. 重新下载库文件并验证完整性

## 获取日志

- 设置 → 开发者选项 → 终端输出：复制或导出日志；安卓/平板支持导出为二维码。
- 提交 issue 时附带日志与平台信息、重现步骤。

---

**⬅️ 上一篇: [常见问题](faq.md)** | **➡️ 下一篇: [隐私与数据](privacy.md)**
